---
import { sanityClient } from "sanity:client";
import { PortableText } from "astro-portabletext";
import { urlFor } from "../utils/image";
import { getImage, Image } from "astro:assets";

import Layout from "../layouts/Layout.astro";

const page = await sanityClient.fetch(`*[_type == "about"][0]{
  title,
  content,
  mainImage{
    asset->{
      _id,
      url
    }
  }
}`);

const mainImage = urlFor(page.mainImage).url();
---

<Layout title={page.title}>
  <section class="page__container">
    <img
      class="page__cover"
      src={urlFor(page.mainImage).url()}
      alt="Cover image"
    />

    <div class="page__content">
      <h1>{page.title}</h1>
      <div class="page__text">
        <PortableText value={page.content} />
      </div>
    </div>
  </section>
</Layout>

<style>
  .page__container {
    width: 100%;
    margin: var(--space-1) 0 var(--space-4);
    display: grid;
    gap: 1rem;
    grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));

    & .page__cover,
    & .page__cover--none {
      width: 100%;
      height: auto;
      object-fit: cover;
      order: 1;
    }

    & .page__cover--none {
      background: var(--black);
    }

    & .page__container {
      padding: 0 var(--space-3);
    }
  }

  @media (min-width: 575px) {
    .page__container {
      width: 100%;
      margin: var(--space-1) 0 var(--space-4);
      display: grid;

      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));

      & .page__cover {
        order: 2;
      }
    }
  }
</style>
